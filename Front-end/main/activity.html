<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏Å‡∏∏‡∏•‡∏à‡∏¥‡∏ô‡∏ï‡πå</title>
    <link rel="stylesheet" href="main.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Overlay for sidebar -->
    <div class="overlay" id="overlay"></div>

    <!-- Sidebar Button -->
    <div class="sidebar-btn" id="sidebarBtn">
        <i class="fas fa-bars"></i>
    </div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <!-- Logo Header -->
        <div class="logo-container-sidebar">
            <img src="../Image/logo.png" alt="‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏Å‡∏∏‡∏•‡∏à‡∏¥‡∏ô‡∏ï‡πå Logo" class="sidebar-logo">
            <div class="close-btn" id="closeSidebarBtn">&times;</div>
        </div>
        <nav class="sidebar-menu">
            <a href="main.html" class="menu-item"><i class="fas fa-home"></i><span>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></a>
            <a href="history.html" class="menu-item"><i class="fas fa-id-card"></i><span>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</span></a>
            <a href="award.html" class="menu-item"><i class="fas fa-award"></i><span>‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏†‡∏≤‡∏Ñ‡∏†‡∏π‡∏°‡∏¥‡πÉ‡∏à</span></a>
            <a href="staff.html" class="menu-item"><i class="fas fa-user"></i><span>‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£</span></a>
            <a href="visitor.html" class="menu-item"><i class="fas fa-users"></i><span>‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°</span></a>
            <a href="activity.html" class="menu-item active"><i class="fas fa-camera"></i><span>‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</span></a>
            <a href="https://www.facebook.com/groups/173373042841553/" target="_blank" class="menu-item">
                <i class="fas fa-comments"></i><span>‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö</span>
            </a>
            <a href="news.html" class="menu-item"><i class="fas fa-book-open"></i><span>‡∏Ç‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</span></a>
            <a href="contact.html" class="menu-item"><i class="fas fa-phone"></i><span>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</span></a>
        </nav>
    </div>

    <!-- Main Content Area -->
    <div class="main-container">
        <!-- Header Section -->
        <header>
            <div class="logo-container">
                <div class="logo">
                    <img src="../Image/logo.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ">
                </div>
                <div>
                    <div class="school-name">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏Å‡∏∏‡∏•‡∏à‡∏¥‡∏ô‡∏ï‡πå</div>
                    <div class="school-name-en">Kunlajin Kindergarten</div>
                </div>
            </div>
            <div class="hamburger" id="hamburgerBtn">
                <i class="fas fa-bars"></i>
            </div>
        </header>

        <!-- Hero Section -->
        <div class="hero">
            <div class="hero-text">
                ‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°<br>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏Å‡∏∏‡∏•‡∏à‡∏¥‡∏ô‡∏ï‡πå
            </div>
            <div class="motto-banner">
                "‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏µ ‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏ò‡∏£‡∏£‡∏° ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ô‡∏≥‡∏ä‡∏∏‡∏°‡∏ä‡∏ô"
            </div>
        </div>

        <div class="main-content">
            <div class="announcement-header">
                <div class="bell-icon">üîî</div>
                <div>‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>
            </div>

            <!-- Loading indicator -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
            </div>

            <!-- Container for activities -->
            <div id="activityContainer" class="activity-grid">
                <!-- Activities will be loaded here dynamically -->
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div class="school-footer-name">‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏Å‡∏∏‡∏•‡∏à‡∏¥‡∏ô‡∏ï‡πå</div>
            <div class="school-address">1 ‡∏ñ‡∏ô‡∏ô‡∏£‡∏ì‡∏†‡∏π‡∏°‡∏¥ ‡∏ï‡∏≥‡∏ö‡∏•‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏™‡∏á‡∏Ç‡∏•‡∏≤ 90110</div>
            <div class="school-contact">Tel. : 074-257884, Fax : 074-258107, E- mail : Kunlajin@gmail.com</div>
        </footer>
    </div>

    <!-- Modal for displaying full-size image and description -->
    <div id="imageModal" class="modal">
        <img id="modalImage" class="modal-content" />
        <div id="modalDescription" class="modal-description"></div>
    </div>

    <!-- JavaScript for the page -->
    <script>
        // Sidebar functionality
        const sidebarBtn = document.getElementById('sidebarBtn');
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const closeSidebarBtn = document.getElementById('closeSidebarBtn');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const mainContainer = document.querySelector('.main-container');

        function openSidebar() {
            sidebar.classList.add('active');
            overlay.style.display = 'block';
        }
        function closeSidebar() {
            sidebar.classList.remove('active');
            overlay.style.display = 'none';
        }
        sidebarBtn.addEventListener('click', openSidebar);
        hamburgerBtn.addEventListener('click', openSidebar);
        closeSidebarBtn.addEventListener('click', closeSidebar);
        overlay.addEventListener('click', closeSidebar);

        window.addEventListener('scroll', function () {
            const header = document.querySelector('header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Modal functionality
        const modal = document.getElementById('imageModal');
        const modalImage = document.getElementById('modalImage');
        const modalDescription = document.getElementById('modalDescription');

        // ‡∏õ‡∏¥‡∏î modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢)
        modal.addEventListener('click', function (event) {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });

        // Fetch and display activities
        async function loadActivities() {
            const activityContainer = document.getElementById('activityContainer');
            const loadingElement = document.getElementById('loading');
            try {
                const response = await fetch('http://localhost:3000/activities');
                const activities = await response.json();
                console.log('activities:', activities);
                loadingElement.style.display = 'none';
                if (activities.length === 0) {
                    activityContainer.innerHTML = '<div class="no-activities">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ</div>';
                    return;
                }
                activityContainer.innerHTML = '';
                activities.forEach(activity => {
                    // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á imagePath ‡πÅ‡∏•‡∏∞ images
                    const images = activity.imagePath || (activity.images ? activity.images.map(img => '/uploads/activity/' + img) : []);
                    console.log('images:', images);
                    const firstImage = images[0] ? "http://localhost:3000" + images[0] : '';
                    console.log('firstImage:', firstImage);

                    const card = document.createElement('div');
                    card.className = 'activity-card';
                    card.innerHTML = `
                        <img src="${firstImage}" alt="‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°" class="activity-image">
                        <div class="activity-info">${activity.detail}</div>
                        <a href="#" class="activity-btn">‡∏î‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</a>
`;
                    card.addEventListener('click', (e) => {
                        e.preventDefault();
                        openModal(images.map(img => "http://localhost:3000" + img), activity.detail);
                    });
                    activityContainer.appendChild(card);
                });
            } catch (error) {
                console.error('Error loading activities:', error);
                loadingElement.style.display = 'none';
                activityContainer.innerHTML = '<div class="no-activities">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>';
            }
        }

        // ‡∏õ‡∏£‡∏±‡∏ö openModal ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏π‡∏õ
        function openModal(imageSrcArray, description) {
            modal.style.display = 'flex';
            modalImage.style.display = 'none'; // ‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏π‡∏õ‡πÄ‡∏î‡∏¥‡∏°

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏û‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Å‡∏£‡∏≠‡∏ö
            let imagesHtml = `<div style="display:flex;gap:16px;justify-content:center;align-items:flex-start;flex-wrap:wrap;">`;
            imageSrcArray.forEach((src, idx) => {
                imagesHtml += `
            <div style="border:2px solid #2196f3;padding:8px;border-radius:8px;text-align:center;min-width:180px;background:#fff;">
                <img src="${src}" class="modal-multi-image" style="max-width:160px;max-height:120px;display:block;margin-bottom:8px;">
                <div style="font-size:14px;color:#2196f3;">‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà ${idx + 1}</div>
            </div>
        `;
            });
            imagesHtml += `</div>`;
            modalDescription.innerHTML = `<div style="margin-bottom:12px;">${description}</div>${imagesHtml}`;
        }

        document.addEventListener('DOMContentLoaded', loadActivities);
    </script>
</body>

</html>